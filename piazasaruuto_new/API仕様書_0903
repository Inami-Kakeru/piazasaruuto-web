# APIä»•æ§˜æ›¸

## äºˆç´„é–¢é€£ API

### GET /api/cal/bookings

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
ãªã—

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "ok": true,
  "where": "/api/cal/bookings"
}
```

### POST /api/cal/bookings

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  // ä»»æ„ã®JSONãƒ‡ãƒ¼ã‚¿
}
```

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "ok": true,
  "where": "/api/cal/bookings",
  "received": {}
}
```

### GET /api/cal/bookings/[uid]

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: `uid` (äºˆç´„ã®UID)

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  // Cal.com APIã‹ã‚‰ã®äºˆç´„è©³ç´°ãƒ‡ãƒ¼ã‚¿
}
```
or
```json
{
  "error": "uid missing"
}
```

### POST /api/cal/bookings/cancel

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "uid": string,
  "reason": string,
  "cancelSubsequent": boolean,
  "seatUid": string
}
```

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  // Cal.com APIã‹ã‚‰ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«çµæœ
}
```
or
```json
{
  "error": "uid is required (booking uid)"
}
```
or
```json
{
  "error": "env missing"
}
```

## ã‚¹ãƒ­ãƒƒãƒˆé–¢é€£ API

### GET /api/cal/slots

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ä»»æ„

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "ok": true,
  "where": "/api/cal/slots",
  "query": {}
}
```

### POST /api/cal/slots/reserve

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  // ä»»æ„ã®JSONãƒ‡ãƒ¼ã‚¿
}
```

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "ok": true,
  "where": "/api/cal/slots/reserve",
  "received": {}
}
```

## Webhook API

### POST /api/cal/webhook

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "event": string,
  "data": object
}
```

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "ok": true
}
```
or
```json
{
  "error": "invalid json"
}
```

## ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ API

### GET /api/health

ğŸ“¤ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
ãªã—

ğŸ“¥ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "ok": true,
  "where": "/api/health"
}
```
or
```json
{
  "ok": false,
  "where": "/api/health"
}
```

## ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å…±é€šå½¢å¼

ã™ã¹ã¦ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ä»¥ä¸‹ã®å½¢å¼ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã•ã‚Œã¾ã™ï¼š

```json
{
  "error": "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
}
```

## ç’°å¢ƒå¤‰æ•°

ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ãŒå¿…è¦ã§ã™ï¼š
- `CAL_BASE_URL`: Cal.com APIã®ãƒ™ãƒ¼ã‚¹URL
- `CAL_API_KEY`: Cal.com APIã‚­ãƒ¼
- `CAL_EVENT_TYPE_ID`: ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ID
- `CAL_WEBHOOK_SECRET`: Webhookç½²åæ¤œè¨¼ç”¨ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆä»»æ„ï¼‰
